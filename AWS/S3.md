# 목차
- [목차](#목차)
- [S3](#s3)
  - [특징](#특징)
  - [버킷과 객체](#버킷과-객체)
  - [내구성 \& 가용성](#내구성--가용성)
  - [보안](#보안)
  - [버킷 정책](#버킷-정책)
    - [모든 파일 허용](#모든-파일-허용)
    - [특정 폴더 허용](#특정-폴더-허용)
    - [특정 IP 허용](#특정-ip-허용)
    - [특정 폴더 다운로드 제한](#특정-폴더-다운로드-제한)

# S3
AWS에서 EC2 서비스와 더불어 가장 오래되고 기본이 되는 객체 스토리지 서비스

Amazon S3는 확장성, 내구성, 보안성이 뛰어난 객체 스토리지 서비스

99.9% (11 9's)의 내구성 제공, 데이터 손실 최소화

데이터 저장 공간이 거의 무제한

전 세계 수백만 기업의 데이터를 저장하는 핵심 서비스

## 특징
객체 스토리지 서비스
- 파일 저장 전용 (EBS / EFS 등 블록 스토리지와 구분) -> 어플리케이션 설치 불가

글로벌 서비스 단위
- 데이터는 특정 리전의 저장됨

무제한 용량 지원
- 단일 객체는 0byte ~ 5TB 저장 가능

최소 3개 이상의 물리적으로 분리된 가용 영역에 데이터 복제

높은 내구성과 고가용성을 제공

OS 도움 없이 객체별 접근 가능, 데이터 저장 및 활용이 용이

## 버킷과 객체
버킷
- S3에서 저장공간을 구분하는 단위 (디렉토리 개념)

- 전 세계 고유 이름을 가져야 함
  - 리전과 무관하게 중복 불가

- 한번 생성 시, 이름 변경 불가

객체
- Owner : 소유자 정보

- Key : 객체 이름 (경로 역할)

- Value : 파일 데이터 자체

- Version ID : 파일 버전 식별자 (버전 관리 활성화 시에만 생성됨)

- Metadata : 파일 관련 정보 (기본 메타데이터 외에 사용자 정의도 가능함)

## 내구성 & 가용성
내구성
- 파일을 잃어버리지 않을 능력

가용성
- 내가 원할 때 그 파일을 쓸 수 있는 능력

최소 3개 AZ에 중복 저장 (Standard 기준)

내구성
- 99.9% -> 파일 손실 확률 극히 낮음

가용성
- SLA: 99.9% 수준

SLA
- Service Level Agreement, 즉 서비스 수준 협약
  - "이 서비스를 얼마나 안정적으로 사용할 수 있는가"
  - 99.95%: 1년 중 약 52분 이하의 다운타임
  - 99.95%: 1년 중 약 1일 18시간 이하 다운

## 보안
기본적으로 모든 객체는 Private(비공개) 상태로 생성됨

퍼블릭 접근은 명시적으로 허용해야 함 (웹 호스팅 등)

Bucket Policy : 버킷 단위 정책

IAM 정책
- Identity-based Policy (자격 증명 기반 정책)
  - IAM 사용자, 그룹, 역할에 부여하는 정책
  - "누가 무엇을 할 수 있는가"를 설정함
- Resource-based Policy (리소스 기반 정책)
  - 리소스 (S3, SQS 등)에 직접 부여하는 정책
  - "이 리소스에 누가 접근 가능한가"를 정의함

## 버킷 정책
버킷 단위로 적용되는 리소스 기반 정책

언제, 어디서, 누가, 무엇을, 어떻게 할 수 있는지 정의

예시
- arn:aws:s3:::my-bucket/images/* -> 해당 경로에 있는 모든 객체 대상으로 권한 설정

익명 사용자 또는 다른 계정에 대한 권한 부여도 가능


### 모든 파일 허용
```json
{
"Effect": "Allow",
"Principal": "*",
"Action": "s3:GetObject",
"Resource": "arn:aws:s3:::버킷이름/*"
}
```

### 특정 폴더 허용
```json
{
"Effect": "Allow",
"Principal": "*",
"Action": "s3:GetObject",
"Resource": "arn:aws:s3:::버킷이름/class/img/*"
}
```

### 특정 IP 허용
```json
"Condition": {
    "IpAddress": {
        "aws:Sourcelp": "123.123.123.123"
    }
}
```

### 특정 폴더 다운로드 제한
```json
{
"Effect": "Deny",
"Principal": "*",
"Action": "s3:GetObject",
"Resource": "arn:aws:s3:::버킷이름/class/test/*"
}
```